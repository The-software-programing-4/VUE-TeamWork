semaphore mutex1=1,mutex2=1

//mutex1 互斥读取

//mutex2 

//empty 余票是否为空

int cnt = N ; //余票的数量

main()

cobegin{

//Q 操作

while(true)

{

   p(mutex1);

   read();

  v(mutex1); 

}

//B操作

while(true)

{

  p(mutex1);

  if(cnt<=0 )

   { v(mutex1); continue; }

   cnt -- ; //购票

  v(mutex1);     

}

}coend