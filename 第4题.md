semaphore mutex1=1,mutex2=1

//mutex1 äº’æ–¥è¯»å–

//mutex2 

//empty ä½™ç¥¨æ˜¯å¦ä¸ºç©º

int cnt = N ; //ä½™ç¥¨çš„æ•°é‡

main()

cobegin{

//Q æ“ä½œ

while(true)

{

   p(mutex1);

   read();

  v(mutex1); 

}

//Bæ“ä½œ

while(true)

{

  p(mutex1);

  if(cnt<=0 )

   { v(mutex1); continue; }

   cnt -- ; //è´­ç¥¨

  v(mutex1);     

}

}coend



```
int count = 0; //Ã­Â‚ÂPÂ£HÃ¶Ã¿ÃgÃ±Ä‹Âš.
semaphore mutex = 1; //Ã²vcountXÄˆÃ‚%Â›Ã±Ä‹
semaphore w = 1; //tÂ¾â€œ0=â€
writer (){
while(1){
P(w);
P(rw);

â€¦
V(rw);
V(w);
} }
reader (){
while(1){
P(w);
P(mutex);
if(count==0)
P(rw);
count++;
V(mutex);
V(w);
Ã¶Âš.â€¦
P(mutex);
count--;
if(count==0)
V(rw);
V(mutex);
} }
```

```
//è¯»æ˜¯ä¸å†™ åªæœ‰è¯»å®Œæ‰èƒ½å†™

semaphore num=N;//ä½™ç¥¨æ•°é‡

int count=0;//è®°å½•å½“å‰æœ‰å‡ ä¸ªQè®¿é—®

semaphore mutex=1;//å¯¹countçš„äº’æ–¥è®¿é—®

semaphore w_N=1;//ä¹°ç¥¨é”

Q(){

P(mutex);

if(count==0) 

P(w_N);//é”numï¼Œä¸èƒ½ä¹°ï¼Œé˜²æ­¢è¯»æ—¶ï¼Œå†™æ”¹å˜äº†æ•°

count++;

V(mutex);//è§£é”count

è¯»ä½™ç¥¨

P(mutex);

count--ï¼›

if(count==0) 

V(w_N);//é‡Šæ”¾numï¼Œå¯ä»¥ä¹°

V(mutex);//è§£é”count

}

B(){

P(w_N);//å…ˆæ£€æŸ¥å¯ä¸å¯å†™

P(N);//ä¹°ç¥¨

V(w_N);

}


```

