semaphore mutex1=1,mutex2=0

//mutex1 确保写互斥

//mutex2 读操作

//empty 余票是否为空

int cnt = N ; //余票的数量

main()

cobegin{

//Q 操作

while(true)

{

   v(mutex2);

   read();

   p(mutex2); 

}

//B操作

while(true)

{

  p(mutex1);

  p(mutex2);

  if(cnt > 0 )

   cnt -- ; //购票

  v(mutex2);

  v(mutex1);     

}

}coend



```
int count = 0; //íP£HöÿÏgñċ.
semaphore mutex = 1; //òvcountXĈÂ%ñċ
semaphore w = 1; //t¾“0=”
writer (){
while(1){
P(w);
P(rw);

…
V(rw);
V(w);
} }
reader (){
while(1){
P(w);
P(mutex);
if(count==0)
P(rw);
count++;
V(mutex);
V(w);
ö.…
P(mutex);
count--;
if(count==0)
V(rw);
V(mutex);
} }
```

