semaphore mutex1=1,mutex2=0

//mutex1 确保写互斥

//mutex2 读操作

//empty 余票是否为空

int cnt = N ; //余票的数量

main()

cobegin{

//Q 操作

while(true)

{

   v(mutex2);

   read();

   p(mutex2); 

}

//B操作

while(true)

{

  p(mutex1);

  p(mutex2);

  if(cnt > 0 )

   cnt -- ; //购票

  v(mutex2);

  v(mutex1);     

}

}coend